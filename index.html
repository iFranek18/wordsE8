<!DOCTYPE html>
<html lang="pl">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>E8 CyberQuest: Legend Edition</title>
    <script src="https://www.gstatic.com/firebasejs/9.17.1/firebase-app-compat.js"></script>
    <script src="https://www.gstatic.com/firebasejs/9.17.1/firebase-database-compat.js"></script>
    <link href="https://fonts.googleapis.com/css2?family=Orbitron:wght@700;900&family=Inter:wght@400;700&display=swap" rel="stylesheet">
    <style>
        :root { --neon: #00f2ff; --bg: #05050a; --gold: #ffd700; --silver: #c0c0c0; --bronze: #cd7f32; }
        body { margin:0; font-family: 'Inter', sans-serif; background: var(--bg); color: #fff; overflow: hidden; height: 100vh; }
        .app { max-width: 480px; margin: 0 auto; padding: 10px; height: 100vh; display: flex; flex-direction: column; box-sizing: border-box; }
        .hidden { display: none !important; }
        
        /* OÅ› NagrÃ³d */
        .road { display: flex; overflow-x: auto; gap: 15px; padding: 15px; background: rgba(255,255,255,0.05); border-radius: 15px; border: 1px solid #333; margin-bottom: 10px; scrollbar-width: none; }
        .node { min-width: 80px; text-align: center; }
        .node-box { width: 50px; height: 50px; background: #1a1a2e; border: 2px solid #444; border-radius: 12px; display: flex; align-items: center; justify-content: center; margin: 0 auto; position: relative; }
        .node.unlocked .node-box { border-color: var(--neon); box-shadow: 0 0 10px var(--neon); }

        .profile-card { background: rgba(15, 15, 30, 0.95); padding: 12px; border-radius: 20px; border: 1px solid #333; display: flex; align-items: center; gap: 12px; margin-bottom: 8px; }
        
        /* Menu GÅ‚Ã³wne */
        .menu-grid { display: grid; grid-template-columns: 1fr 1fr; gap: 8px; margin-bottom: 8px; }
        button { width: 100%; padding: 12px; border-radius: 10px; border: none; font-weight: 800; cursor: pointer; font-family: 'Orbitron'; text-transform: uppercase; color: #fff; font-size: 0.7rem; transition: 0.2s; }
        button:active { transform: scale(0.95); }
        .btn-rank { background: linear-gradient(135deg, #ff416c, #ff4b2b); grid-column: span 2; font-size: 0.9rem; }
        .btn-learn { background: linear-gradient(135deg, #00d2ff, #3a7bd5); }
        .btn-shop { background: #e67e22; }
        .btn-locker { background: #6c5ce7; }
        .btn-multi { background: #2d3436; grid-column: span 2; }
        .spotify-btn { background: #1DB954; grid-column: span 2; }

        /* Ranking */
        .rank-1 { color: var(--gold); text-shadow: 0 0 10px var(--gold); font-weight: 900; }
        .rank-2 { color: var(--silver); text-shadow: 0 0 10px var(--silver); }
        .rank-3 { color: var(--bronze); text-shadow: 0 0 10px var(--bronze); }
        
        .item-grid { display: grid; grid-template-columns: repeat(4, 1fr); gap: 8px; overflow-y: auto; }
        .shop-card { background: #111; border: 1px solid #333; padding: 10px; border-radius: 12px; text-align: center; }
        input { width: 100%; padding: 12px; border-radius: 10px; border: 2px solid #333; background: #000; color: #fff; text-align: center; font-family: 'Orbitron'; margin-bottom: 10px; }
    </style>
</head>
<body>

<div class="app" id="screen-menu">
    <div class="road" id="road-ui"></div>

    <div class="profile-card">
        <div id="p-avatar" style="font-size:1.8rem; width:50px; height:50px; background:#000; border:2px solid var(--neon); border-radius:12px; display:flex; align-items:center; justify-content:center">ğŸ‘¶ğŸ»</div>
        <div style="flex:1">
            <h2 id="p-name" style="margin:0; font-size:0.9rem; font-family:'Orbitron'">ÅADUJÄ˜...</h2>
            <div style="font-size:0.6rem">ğŸ† <span id="p-cups">0</span> | ğŸ’° <span id="p-coins">0</span> | ğŸ’£ <span id="p-bombs">0</span> | âš¡ <span id="p-x2">0</span></div>
        </div>
        <div onclick="showScreen('screen-settings')" style="cursor:pointer; font-size:1.5rem">âš™ï¸</div>
    </div>

    <div class="menu-grid">
        <button class="btn-rank" onclick="openArenaSelector('rank')">GRA RANKINGOWA ğŸŸï¸</button>
        <button class="btn-learn" onclick="openArenaSelector('learn')">LEKCJA: SÅOWA ğŸ“–</button>
        <button class="btn-learn" style="background:#0984e3" onclick="openArenaSelector('learn_sentences')">LEKCJA: ZDANIA âœï¸</button>
        <button class="btn-shop" onclick="showScreen('screen-shop')">SKLEP ğŸ’°</button>
        <button class="btn-locker" onclick="showScreen('screen-locker')">SZAFKA ğŸ‘•</button>
        <button style="background:#2ecc71" onclick="showScreen('screen-dict')">SÅOWNIK AREN ğŸ“š</button>
        <button class="btn-multi" onclick="showScreen('screen-multi')">GRA ONLINE ğŸŒ</button>
        <button class="spotify-btn" onclick="window.open('https://open.spotify.com', '_blank')">MOJA PLAYLISTA ğŸµ</button>
    </div>

    <div style="background:rgba(255,255,255,0.05); border-radius:15px; flex:1; overflow-y:auto; padding:10px; border:1px solid #222">
        <h4 style="margin:0 0 5px 0; font-family:'Orbitron'; font-size:0.6rem; color:var(--neon)">GLOBAL RANKING</h4>
        <div id="leader-list" style="font-size:0.75rem"></div>
    </div>
</div>

<div class="app hidden" id="screen-dict">
    <button onclick="showScreen('screen-menu')">POWRÃ“T</button>
    <h3 style="font-family:'Orbitron'; text-align:center">ARENY</h3>
    <div id="arena-grid" style="display:grid; gap:10px"></div>
</div>

<div class="app hidden" id="screen-game">
    <div style="display:flex; justify-content:space-between; font-family:'Orbitron'; font-size:0.7rem; color:var(--neon)">
        <span id="g-arena-name">ARENA 1</span>
        <span>Å»YCIA: <span id="g-lives">â¤ï¸â¤ï¸â¤ï¸</span></span>
    </div>
    <div id="g-word" style="font-size:2rem; margin:60px 0; text-align:center; font-family:'Orbitron'; text-shadow:0 0 10px var(--neon)">WORD</div>
    <input type="text" id="g-input" placeholder="TÅUMACZENIE..." autocomplete="off">
    <button style="background:#00b894" onclick="checkAnswer()">SPRAWDÅ¹ âœ…</button>
    <div id="g-feedback" style="text-align:center; margin-top:20px; font-weight:bold"></div>
</div>

<div class="app hidden" id="screen-shop">
    <button onclick="showScreen('screen-menu')">POWRÃ“T</button>
    <h3 style="font-family:'Orbitron'; text-align:center">SKLEP</h3>
    <div id="shop-items" class="item-grid"></div>
</div>

<div class="app hidden" id="screen-locker">
    <button onclick="showScreen('screen-menu')">POWRÃ“T</button>
    <h3 style="font-family:'Orbitron'; text-align:center">SZAFKA</h3>
    <div id="locker-items" class="item-grid"></div>
</div>

<div class="app hidden" id="screen-settings">
    <button onclick="showScreen('screen-menu')">POWRÃ“T</button>
    <div style="background:rgba(255,255,255,0.05); padding:20px; border-radius:20px; margin-top:10px">
        <h4 style="font-family:'Orbitron'">USTAWIENIA</h4>
        <input type="text" id="new-nick" placeholder="ZMIEÅƒ NICK...">
        <button class="btn-learn" onclick="updateNick()">ZAPISZ</button>
        <button style="background:#444; margin-top:10px">DÅ¹WIÄ˜K: ON</button>
        <hr style="border:0; border-top:1px solid #333; margin:20px 0">
        <h4 style="font-family:'Orbitron'; color:var(--neon)">INFORMACJE</h4>
        <div style="font-size:0.7rem; line-height:1.4">
            <b>Gra Rankingowa:</b> 50ğŸ† (A1: 50 sÅ‚Ã³w, A2-5: 30 sÅ‚Ã³w).<br>
            <b>Lekcja:</b> 0-1 bÅ‚Ä…d (25ğŸ†), 2-3 bÅ‚Ä™dy (15ğŸ†), >3 (0ğŸ†).<br>
            BÅ‚Ä™dy w rankingu wracajÄ… na koniec sesji!
        </div>
    </div>
</div>

<script>
// --- KONFIGURACJA FIREBASE ---
const firebaseConfig = { apiKey: "AIzaSyCREz6ZMk86TW-dASBLNIHUTr5XDXZrTPE", authDomain: "english-game-d3ccd.firebaseapp.com", databaseURL: "https://english-game-d3ccd-default-rtdb.europe-west1.firebasedatabase.app", projectId: "english-game-d3ccd" };
firebase.initializeApp(firebaseConfig);
const db = firebase.database();

// ==========================================
// --- MIEJSCE NA TWOJE SÅOWA ---
// ==========================================
const ARENA_DATA = {
    1: [
        {en:"I", pl:"ja"}, {en:"you", pl:"ty / wy"}, {en:"he", pl:"on"}, {en:"she", pl:"ona"}, {en:"it", pl:"ono / to"}, {en:"we", pl:"my"}, {en:"they", pl:"oni / one"}, {en:"me", pl:"mnie / mi"}, {en:"him", pl:"jego / mu"}, {en:"her", pl:"jej"}, {en:"us", pl:"nas / nam"}, {en:"them", pl:"ich / im"}, {en:"my", pl:"mÃ³j"}, {en:"your", pl:"twÃ³j / wasz"}, {en:"his", pl:"jego"}, {en:"its", pl:"jego / jej (rzeczy, zwierzÄ™ta)"}, {en:"our", pl:"nasz"}, {en:"their", pl:"ich"}, {en:"what", pl:"co"}, {en:"which", pl:"ktÃ³ry / ktÃ³ra / ktÃ³re"}, {en:"who", pl:"kto"}, {en:"whom", pl:"kogo / komu"}, {en:"whose", pl:"czyj / czyja / czyje"}, {en:"where", pl:"gdzie"}, {en:"when", pl:"kiedy"}, {en:"why", pl:"dlaczego"}, {en:"how", pl:"jak"}, {en:"in", pl:"w"}, {en:"on", pl:"na"}, {en:"at", pl:"przy / o (czas)"}, {en:"to", pl:"do"}, {en:"from", pl:"z / od"}, {en:"with", pl:"z"}, {en:"about", pl:"o"}, {en:"for", pl:"dla / za"}, {en:"of", pl:"(czegoÅ›)"}, {en:"into", pl:"do (wnÄ™trza)"}, {en:"out", pl:"na zewnÄ…trz"}, {en:"up", pl:"w gÃ³rÄ™"}, {en:"down", pl:"w dÃ³Å‚"}, {en:"between", pl:"miÄ™dzy"}, {en:"among", pl:"wÅ›rÃ³d"}, {en:"over", pl:"nad"}, {en:"under", pl:"pod"}, {en:"behind", pl:"za"}, {en:"next to", pl:"obok"}, {en:"near", pl:"blisko"}, {en:"and", pl:"i"}, {en:"but", pl:"ale"}, {en:"or", pl:"lub"}, {en:"because", pl:"poniewaÅ¼"}, {en:"so", pl:"wiÄ™c"}, {en:"if", pl:"jeÅ›li"}, {en:"although", pl:"chociaÅ¼"}, {en:"while", pl:"podczas gdy"}, {en:"then", pl:"potem / wtedy"}, {en:"after", pl:"po"}, {en:"before", pl:"przed"}, {en:"here", pl:"tutaj"}, {en:"there", pl:"tam"}, {en:"now", pl:"teraz"}, {en:"always", pl:"zawsze"}, {en:"usually", pl:"zazwyczaj"}, {en:"sometimes", pl:"czasami"}, {en:"never", pl:"nigdy"}, {en:"also", pl:"takÅ¼e"}, {en:"too", pl:"teÅ¼"}, {en:"very", pl:"bardzo"}, {en:"quite", pl:"caÅ‚kiem"}, {en:"really", pl:"naprawdÄ™"}, {en:"maybe", pl:"moÅ¼e"}, {en:"well", pl:"dobrze"}, {en:"mother", pl:"mama"}, {en:"father", pl:"tata"}, {en:"parents", pl:"rodzice"}, {en:"sister", pl:"siostra"}, {en:"brother", pl:"brat"}, {en:"grandmother", pl:"babcia"}, {en:"grandfather", pl:"dziadek"}, {en:"aunt", pl:"ciocia"}, {en:"uncle", pl:"wujek"}, {en:"cousin", pl:"kuzyn / kuzynka"}, {en:"child", pl:"dziecko"}, {en:"children", pl:"dzieci"}, {en:"baby", pl:"niemowlÄ™"}, {en:"friend", pl:"przyjaciel"}, {en:"best friend", pl:"najlepszy przyjaciel"}, {en:"neighbour", pl:"sÄ…siad"}, {en:"person", pl:"osoba"}, {en:"people", pl:"ludzie"}, {en:"teenager", pl:"nastolatek"}, {en:"adult", pl:"dorosÅ‚y"}, {en:"school", pl:"szkoÅ‚a"}, {en:"class", pl:"klasa"}, {en:"lesson", pl:"lekcja"}, {en:"subject", pl:"przedmiot"}, {en:"exam", pl:"egzamin"}, {en:"test", pl:"test"}, {en:"homework", pl:"praca domowa"}, {en:"exercise", pl:"Ä‡wiczenie"}, {en:"task", pl:"zadanie"}, {en:"question", pl:"pytanie"}, {en:"answer", pl:"odpowiedÅº"}, {en:"break", pl:"przerwa"}, {en:"teacher", pl:"nauczyciel"}, {en:"student", pl:"uczeÅ„"}, {en:"classmate", pl:"kolega z klasy"}, {en:"headteacher", pl:"dyrektor"}, {en:"book", pl:"ksiÄ…Å¼ka"}, {en:"textbook", pl:"podrÄ™cznik"}, {en:"notebook", pl:"zeszyt"}, {en:"pen", pl:"dÅ‚ugopis"}, {en:"pencil", pl:"oÅ‚Ã³wek"}, {en:"desk", pl:"Å‚awka / biurko"}, {en:"chair", pl:"krzesÅ‚o"}, {en:"board", pl:"tablica"}, {en:"grade", pl:"ocena"}, {en:"project", pl:"projekt"}, {en:"English", pl:"angielski"}, {en:"Polish", pl:"polski"}, {en:"maths", pl:"matematyka"}, {en:"history", pl:"historia"}, {en:"geography", pl:"geografia"}, {en:"biology", pl:"biologia"}, {en:"chemistry", pl:"chemia"}, {en:"physics", pl:"fizyka"}, {en:"music", pl:"muzyka"}, {en:"art", pl:"plastyka"}, {en:"PE", pl:"WF"}, {en:"IT", pl:"informatyka"}, {en:"doctor", pl:"lekarz"}, {en:"nurse", pl:"pielÄ™gniarka"}, {en:"paramedic", pl:"ratownik medyczny"}, {en:"police officer", pl:"policjant"}, {en:"firefighter", pl:"straÅ¼ak"}, {en:"soldier", pl:"Å¼oÅ‚nierz"}, {en:"lawyer", pl:"prawnik"}, {en:"worker", pl:"pracownik"}, {en:"manager", pl:"menedÅ¼er"}, {en:"actor", pl:"aktor"}, {en:"singer", pl:"piosenkarz"}, {en:"driver", pl:"kierowca"}, {en:"mechanic", pl:"mechanik"}, {en:"engineer", pl:"inÅ¼ynier"}, {en:"builder", pl:"budowlaniec"}, {en:"architect", pl:"architekt"}, {en:"electrician", pl:"elektryk"}, {en:"plumber", pl:"hydraulik"}, {en:"shop assistant", pl:"sprzedawca"}, {en:"cashier", pl:"kasjer"}, {en:"cook", pl:"kucharz"}, {en:"waiter", pl:"kelner"}, {en:"farmer", pl:"rolnik"}, {en:"gardener", pl:"ogrodnik"}, {en:"vet", pl:"weterynarz"}, {en:"scientist", pl:"naukowiec"}, {en:"journalist", pl:"dziennikarz"}, {en:"photographer", pl:"fotograf"}, {en:"translator", pl:"tÅ‚umacz"}, {en:"volunteer", pl:"wolontariusz"}, {en:"house", pl:"dom"}, {en:"flat", pl:"mieszkanie"}, {en:"building", pl:"budynek"}, {en:"basement", pl:"piwnica"}, {en:"floor", pl:"piÄ™tro / podÅ‚oga"}, {en:"room", pl:"pokÃ³j"}, {en:"living room", pl:"salon"}, {en:"bedroom", pl:"sypialnia"}, {en:"kitchen", pl:"kuchnia"}, {en:"bathroom", pl:"Å‚azienka"}, {en:"hall", pl:"korytarz"}, {en:"door", pl:"drzwi"}, {en:"window", pl:"okno"}, {en:"wall", pl:"Å›ciana"}, {en:"roof", pl:"dach"}, {en:"stairs", pl:"schody"}, {en:"garden", pl:"ogrÃ³d"}, {en:"garage", pl:"garaÅ¼"}, {en:"table", pl:"stÃ³Å‚"}, {en:"bed", pl:"Å‚Ã³Å¼ko"}, {en:"wardrobe", pl:"szafa"}, {en:"shelf", pl:"pÃ³Å‚ka"}, {en:"lamp", pl:"lampa"}, {en:"mirror", pl:"lustro"}, {en:"clock", pl:"zegar"}, {en:"phone", pl:"telefon"}, {en:"computer", pl:"komputer"}, {en:"laptop", pl:"laptop"}, {en:"keyboard", pl:"klawiatura"}, {en:"mouse", pl:"myszka"}, {en:"screen", pl:"ekran"}, {en:"TV", pl:"telewizor"}, {en:"remote", pl:"pilot"}, {en:"charger", pl:"Å‚adowarka"}, {en:"bag", pl:"torba"}, {en:"backpack", pl:"plecak"}, {en:"keys", pl:"klucze"}, {en:"money", pl:"pieniÄ…dze"}, {en:"wallet", pl:"portfel"}, {en:"food", pl:"jedzenie"}, {en:"meal", pl:"posiÅ‚ek"}, {en:"breakfast", pl:"Å›niadanie"}, {en:"lunch", pl:"lunch"}, {en:"dinner", pl:"obiad"}, {en:"snack", pl:"przekÄ…ska"}, {en:"bread", pl:"chleb"}, {en:"butter", pl:"masÅ‚o"}, {en:"cheese", pl:"ser"}, {en:"milk", pl:"mleko"}, {en:"water", pl:"woda"}, {en:"juice", pl:"sok"}, {en:"tea", pl:"herbata"}, {en:"coffee", pl:"kawa"}, {en:"meat", pl:"miÄ™so"}, {en:"fish", pl:"ryba"}, {en:"fruit", pl:"owoce"}, {en:"vegetables", pl:"warzywa"}, {en:"apple", pl:"jabÅ‚ko"}, {en:"banana", pl:"banan"}, {en:"cake", pl:"ciasto"}, {en:"animal", pl:"zwierzÄ™"}, {en:"pet", pl:"zwierzÄ™ domowe"}, {en:"dog", pl:"pies"}, {en:"cat", pl:"kot"}, {en:"bird", pl:"ptak"}, {en:"horse", pl:"koÅ„"}, {en:"cow", pl:"krowa"}, {en:"pig", pl:"Å›winia"}, {en:"sheep", pl:"owca"}, {en:"goat", pl:"koza"}, {en:"rabbit", pl:"krÃ³lik"}, {en:"hamster", pl:"chomik"}, {en:"mouse", pl:"mysz"}, {en:"lion", pl:"lew"}, {en:"tiger", pl:"tygrys"}, {en:"bear", pl:"niedÅºwiedÅº"}, {en:"elephant", pl:"sÅ‚oÅ„"}, {en:"wolf", pl:"wilk"}, {en:"fox", pl:"lis"}, {en:"city", pl:"miasto"}, {en:"village", pl:"wieÅ›"}, {en:"street", pl:"ulica"}, {en:"road", pl:"droga"}, {en:"square", pl:"plac"}, {en:"park", pl:"park"}, {en:"shop", pl:"sklep"}, {en:"market", pl:"targ"}, {en:"restaurant", pl:"restauracja"}, {en:"cinema", pl:"kino"}, {en:"museum", pl:"muzeum"}, {en:"library", pl:"biblioteka"}, {en:"hospital", pl:"szpital"}, {en:"office", pl:"biuro"}, {en:"airport", pl:"lotnisko"}, {en:"car", pl:"samochÃ³d"}, {en:"bus", pl:"autobus"}, {en:"train", pl:"pociÄ…g"}, {en:"tram", pl:"tramwaj"}, {en:"bike", pl:"rower"}, {en:"plane", pl:"samolot"}, {en:"ship", pl:"statek"}, {en:"ticket", pl:"bilet"}, {en:"journey", pl:"podrÃ³Å¼"}, {en:"time", pl:"czas"}, {en:"day", pl:"dzieÅ„"}, {en:"week", pl:"tydzieÅ„"}, {en:"month", pl:"miesiÄ…c"}, {en:"year", pl:"rok"}, {en:"morning", pl:"rano"}, {en:"night", pl:"noc"}, {en:"holiday", pl:"wakacje"}, {en:"weekend", pl:"weekend"}, {en:"body", pl:"ciaÅ‚o"}, {en:"head", pl:"gÅ‚owa"}, {en:"hair", pl:"wÅ‚osy"}, {en:"face", pl:"twarz"}, {en:"eye", pl:"oko"}, {en:"ear", pl:"ucho"}, {en:"nose", pl:"nos"}, {en:"mouth", pl:"usta"}, {en:"hand", pl:"rÄ™ka"}, {en:"leg", pl:"noga"}, {en:"heart", pl:"serce"}, {en:"nature", pl:"przyroda"}, {en:"weather", pl:"pogoda"}, {en:"sun", pl:"sÅ‚oÅ„ce"}, {en:"rain", pl:"deszcz"}, {en:"snow", pl:"Å›nieg"}, {en:"wind", pl:"wiatr"}, {en:"sky", pl:"niebo"}, {en:"tree", pl:"drzewo"}, {en:"flower", pl:"kwiat"}, {en:"river", pl:"rzeka"}, {en:"lake", pl:"jezioro"}, {en:"sea", pl:"morze"}, {en:"mountain", pl:"gÃ³ra"}, {en:"forest", pl:"las"}, {en:"hobby", pl:"hobby"}, {en:"sport", pl:"sport"}, {en:"game", pl:"gra"}, {en:"music", pl:"muzyka"}, {en:"film", pl:"film"}, {en:"problem", pl:"problem"}, {en:"idea", pl:"pomysÅ‚"}, {en:"information", pl:"informacja"}, {en:"success", pl:"sukces"}, {en:"failure", pl:"poraÅ¼ka"}, {en:"be", pl:"byÄ‡"}, {en:"have", pl:"mieÄ‡"}, {en:"do", pl:"robiÄ‡"}, {en:"say", pl:"mÃ³wiÄ‡"}, {en:"tell", pl:"powiedzieÄ‡"}, {en:"ask", pl:"pytaÄ‡"}, {en:"answer", pl:"odpowiadaÄ‡"}, {en:"talk", pl:"rozmawiaÄ‡"}, {en:"listen", pl:"sÅ‚uchaÄ‡"}, {en:"see", pl:"widzieÄ‡"}, {en:"watch", pl:"oglÄ…daÄ‡"}, {en:"look", pl:"patrzeÄ‡"}, {en:"read", pl:"czytaÄ‡"}, {en:"write", pl:"pisaÄ‡"}, {en:"learn", pl:"uczyÄ‡ siÄ™"}, {en:"know", pl:"wiedzieÄ‡"}, {en:"think", pl:"myÅ›leÄ‡"}, {en:"understand", pl:"rozumieÄ‡"}, {en:"go", pl:"iÅ›Ä‡ / jechaÄ‡"}, {en:"come", pl:"przychodziÄ‡"}, {en:"get", pl:"dostaÄ‡ / staÄ‡ siÄ™"}, {en:"make", pl:"robiÄ‡"}, {en:"take", pl:"braÄ‡"}, {en:"give", pl:"dawaÄ‡"}, {en:"use", pl:"uÅ¼ywaÄ‡"}, {en:"work", pl:"pracowaÄ‡"}, {en:"play", pl:"graÄ‡"}, {en:"stop", pl:"zatrzymywaÄ‡"}, {en:"happy", pl:"szczÄ™Å›liwy"}, {en:"sad", pl:"smutny"}, {en:"angry", pl:"zÅ‚y"}, {en:"tired", pl:"zmÄ™czony"}, {en:"difficult", pl:"trudny"}, {en:"easy", pl:"Å‚atwy"}, {en:"tall", pl:"wysoki"}, {en:"short", pl:"niski / krÃ³tki"}, {en:"big", pl:"duÅ¼y"}, {en:"small", pl:"maÅ‚y"}, {en:"young", pl:"mÅ‚ody"}, {en:"old", pl:"stary"}, {en:"beautiful", pl:"piÄ™kny"}, {en:"expensive", pl:"drogi"}, {en:"cheap", pl:"tani"}, {en:"fast", pl:"szybki"}, {en:"slow", pl:"wolny"}, {en:"good", pl:"dobry"}, {en:"bad", pl:"zÅ‚y"},
    ],
    2: [
        {en:"become", pl:"stawaÄ‡ siÄ™"}, {en:"seem", pl:"wydawaÄ‡ siÄ™"}, {en:"change", pl:"zmieniaÄ‡"}, {en:"start", pl:"zaczynaÄ‡"}, {en:"finish", pl:"koÅ„czyÄ‡"}, {en:"help", pl:"pomagaÄ‡"}, {en:"wait", pl:"czekaÄ‡"}, {en:"stay", pl:"zostawaÄ‡"}, {en:"leave", pl:"opuszczaÄ‡"}, {en:"find", pl:"znajdowaÄ‡"}, {en:"lose", pl:"gubiÄ‡ / traciÄ‡"}, {en:"win", pl:"wygrywaÄ‡"}, {en:"choose", pl:"wybieraÄ‡"}, {en:"try", pl:"prÃ³bowaÄ‡"}, {en:"need", pl:"potrzebowaÄ‡"}, {en:"want", pl:"chcieÄ‡"}, {en:"like", pl:"lubiÄ‡"}, {en:"love", pl:"kochaÄ‡"}, {en:"hate", pl:"nienawidziÄ‡"}, {en:"enjoy", pl:"cieszyÄ‡ siÄ™"}, {en:"think", pl:"myÅ›leÄ‡"}, {en:"know", pl:"wiedzieÄ‡"}, {en:"learn", pl:"uczyÄ‡ siÄ™"}, {en:"remember", pl:"pamiÄ™taÄ‡"}, {en:"forget", pl:"zapominaÄ‡"}, {en:"hope", pl:"mieÄ‡ nadziejÄ™"}, {en:"believe", pl:"wierzyÄ‡"}, {en:"feel", pl:"czuÄ‡"}, {en:"look", pl:"wyglÄ…daÄ‡"}, {en:"sound", pl:"brzmieÄ‡"}, {en:"work", pl:"pracowaÄ‡"}, {en:"play", pl:"graÄ‡"}, {en:"live", pl:"mieszkaÄ‡"}, {en:"travel", pl:"podrÃ³Å¼owaÄ‡"}, {en:"arrive", pl:"przyjeÅ¼dÅ¼aÄ‡"}, {en:"return", pl:"wracaÄ‡"}, {en:"move", pl:"ruszaÄ‡ siÄ™"}, {en:"stop", pl:"zatrzymywaÄ‡"}, {en:"open", pl:"otwieraÄ‡"}, {en:"close", pl:"zamykaÄ‡"}, {en:"buy", pl:"kupowaÄ‡"}, {en:"sell", pl:"sprzedawaÄ‡"}, {en:"pay", pl:"pÅ‚aciÄ‡"}, {en:"cost", pl:"kosztowaÄ‡"}, {en:"spend", pl:"wydawaÄ‡"}, {en:"save", pl:"oszczÄ™dzaÄ‡"}, {en:"share", pl:"dzieliÄ‡ siÄ™"}, {en:"meet", pl:"spotykaÄ‡"}, {en:"visit", pl:"odwiedzaÄ‡"}, {en:"follow", pl:"podÄ…Å¼aÄ‡"},
    ],
    3: [
        {en:"decide", pl:"decydowaÄ‡"}, {en:"plan", pl:"planowaÄ‡"}, {en:"prepare", pl:"przygotowywaÄ‡"}, {en:"organize", pl:"organizowaÄ‡"}, {en:"arrange", pl:"ustalaÄ‡"}, {en:"manage", pl:"zarzÄ…dzaÄ‡"}, {en:"control", pl:"kontrolowaÄ‡"}, {en:"improve", pl:"poprawiaÄ‡"}, {en:"reduce", pl:"zmniejszaÄ‡"}, {en:"increase", pl:"zwiÄ™kszaÄ‡"}, {en:"create", pl:"tworzyÄ‡"}, {en:"destroy", pl:"niszczyÄ‡"}, {en:"build", pl:"budowaÄ‡"}, {en:"repair", pl:"naprawiaÄ‡"}, {en:"replace", pl:"zastÄ™powaÄ‡"}, {en:"protect", pl:"chroniÄ‡"}, {en:"allow", pl:"pozwalaÄ‡"}, {en:"prevent", pl:"zapobiegaÄ‡"}, {en:"refuse", pl:"odmawiaÄ‡"}, {en:"accept", pl:"akceptowaÄ‡"}, {en:"explain", pl:"wyjaÅ›niaÄ‡"}, {en:"describe", pl:"opisywaÄ‡"}, {en:"mention", pl:"wspominaÄ‡"}, {en:"complain", pl:"narzekaÄ‡"}, {en:"promise", pl:"obiecywaÄ‡"}, {en:"warn", pl:"ostrzegaÄ‡"}, {en:"advise", pl:"doradzaÄ‡"}, {en:"suggest", pl:"sugerowaÄ‡"}, {en:"agree", pl:"zgadzaÄ‡ siÄ™"}, {en:"disagree", pl:"nie zgadzaÄ‡ siÄ™"}, {en:"support", pl:"wspieraÄ‡"}, {en:"oppose", pl:"sprzeciwiaÄ‡ siÄ™"}, {en:"trust", pl:"ufaÄ‡"}, {en:"blame", pl:"obwiniaÄ‡"}, {en:"punish", pl:"karaÄ‡"}, {en:"reward", pl:"nagradzaÄ‡"}, {en:"reject", pl:"odrzucaÄ‡"}, {en:"cancel", pl:"odwoÅ‚ywaÄ‡"}, {en:"continue", pl:"kontynuowaÄ‡"}, {en:"break", pl:"Å‚amaÄ‡"}, {en:"cut", pl:"ciÄ…Ä‡"}, {en:"catch", pl:"Å‚apaÄ‡"}, {en:"hide", pl:"chowaÄ‡"}, {en:"escape", pl:"uciekaÄ‡"}, {en:"survive", pl:"przetrwaÄ‡"}, {en:"rescue", pl:"ratowaÄ‡"}, {en:"attack", pl:"atakowaÄ‡"}, {en:"defend", pl:"broniÄ‡"}, {en:"risk", pl:"ryzykowaÄ‡"},
    ],
    4: [
       {en:"appear", pl:"pojawiaÄ‡ siÄ™"}, {en:"disappear", pl:"znikaÄ‡"}, {en:"remain", pl:"pozostawaÄ‡"}, {en:"belong", pl:"naleÅ¼eÄ‡"}, {en:"include", pl:"zawieraÄ‡"}, {en:"contain", pl:"zawieraÄ‡"}, {en:"affect", pl:"wpÅ‚ywaÄ‡"}, {en:"depend", pl:"zaleÅ¼eÄ‡"}, {en:"realize", pl:"uÅ›wiadamiaÄ‡ sobie"}, {en:"expect", pl:"oczekiwaÄ‡"}, {en:"imagine", pl:"wyobraÅ¼aÄ‡ sobie"}, {en:"consider", pl:"rozwaÅ¼aÄ‡"}, {en:"admit", pl:"przyznawaÄ‡ siÄ™"}, {en:"deny", pl:"zaprzeczaÄ‡"}, {en:"demand", pl:"Å¼Ä…daÄ‡"}, {en:"request", pl:"prosiÄ‡ formalnie"}, {en:"encourage", pl:"zachÄ™caÄ‡"}, {en:"force", pl:"zmuszaÄ‡"}, {en:"discover", pl:"odkrywaÄ‡"}, {en:"invent", pl:"wynajdywaÄ‡"}, {en:"explore", pl:"eksplorowaÄ‡"}, {en:"research", pl:"badaÄ‡"}, {en:"test", pl:"testowaÄ‡"}, {en:"prove", pl:"udowadniaÄ‡"}, {en:"doubt", pl:"wÄ…tpiÄ‡"}, {en:"notice", pl:"zauwaÅ¼aÄ‡"}, {en:"observe", pl:"obserwowaÄ‡"}, {en:"compare", pl:"porÃ³wnywaÄ‡"}, {en:"connect", pl:"Å‚Ä…czyÄ‡"}, {en:"separate", pl:"oddzielaÄ‡"}, {en:"collect", pl:"zbieraÄ‡"}, {en:"store", pl:"przechowywaÄ‡"}, {en:"waste", pl:"marnowaÄ‡"}, {en:"earn", pl:"zarabiaÄ‡"}, {en:"borrow", pl:"poÅ¼yczaÄ‡"}, {en:"lend", pl:"poÅ¼yczaÄ‡ komuÅ›"}, {en:"afford", pl:"pozwoliÄ‡ sobie"}, {en:"invest", pl:"inwestowaÄ‡"}, {en:"deliver", pl:"dostarczaÄ‡"}, {en:"depart", pl:"odjeÅ¼dÅ¼aÄ‡"}, {en:"chase", pl:"goniÄ‡"}, {en:"guide", pl:"prowadziÄ‡"}, {en:"lead", pl:"przewodziÄ‡"}, {en:"follow", pl:"naÅ›ladowaÄ‡"}, {en:"calm", pl:"uspokajaÄ‡"}, {en:"relax", pl:"relaksowaÄ‡ siÄ™"}, {en:"stress", pl:"stresowaÄ‡"}, {en:"worry", pl:"martwiÄ‡ siÄ™"}, {en:"satisfy", pl:"zadowalaÄ‡"}, {en:"disappoint", pl:"rozczarowywaÄ‡"},
    ],
    5: [
        {en:"achieve", pl:"osiÄ…gaÄ‡"}, {en:"succeed", pl:"odnosiÄ‡ sukces"}, {en:"fail", pl:"ponosiÄ‡ poraÅ¼kÄ™"}, {en:"handle", pl:"radziÄ‡ sobie"}, {en:"avoid", pl:"unikaÄ‡"}, {en:"influence", pl:"wpÅ‚yw"}, {en:"responsibility", pl:"odpowiedzialnoÅ›Ä‡"}, {en:"freedom", pl:"wolnoÅ›Ä‡"}, {en:"justice", pl:"sprawiedliwoÅ›Ä‡"}, {en:"society", pl:"spoÅ‚eczeÅ„stwo"}, {en:"community", pl:"spoÅ‚ecznoÅ›Ä‡"}, {en:"environment", pl:"Å›rodowisko"}, {en:"pollution", pl:"zanieczyszczenie"}, {en:"climate", pl:"klimat"}, {en:"resource", pl:"zasÃ³b"}, {en:"energy", pl:"energia"}, {en:"technology", pl:"technologia"}, {en:"device", pl:"urzÄ…dzenie"}, {en:"system", pl:"system"}, {en:"process", pl:"proces"}, {en:"method", pl:"metoda"}, {en:"impact", pl:"wpÅ‚yw"}, {en:"result", pl:"rezultat"}, {en:"effect", pl:"skutek"}, {en:"cause", pl:"przyczyna"}, {en:"solution", pl:"rozwiÄ…zanie"}, {en:"opportunity", pl:"okazja"}, {en:"priority", pl:"priorytet"}, {en:"balance", pl:"rÃ³wnowaga"}, {en:"limit", pl:"ograniczenie"}, {en:"quality", pl:"jakoÅ›Ä‡"}, {en:"value", pl:"wartoÅ›Ä‡"}, {en:"budget", pl:"budÅ¼et"}, {en:"profit", pl:"zysk"}, {en:"loss", pl:"strata"}, {en:"role", pl:"rola"}, {en:"position", pl:"pozycja"}, {en:"power", pl:"wÅ‚adza"}, {en:"habit", pl:"nawyk"}, {en:"lifestyle", pl:"styl Å¼ycia"}, {en:"culture", pl:"kultura"}, {en:"tradition", pl:"tradycja"}, {en:"belief", pl:"przekonanie"}, {en:"symbol", pl:"symbol"}, {en:"meaning", pl:"znaczenie"}, {en:"language", pl:"jÄ™zyk"}, {en:"translation", pl:"tÅ‚umaczenie"}, {en:"character", pl:"postaÄ‡"}, {en:"plot", pl:"fabuÅ‚a"}, {en:"audience", pl:"publicznoÅ›Ä‡"}, {en:"review", pl:"recenzja"}, {en:"opinion", pl:"opinia"}, {en:"fact", pl:"fakt"}, {en:"truth", pl:"prawda"}, {en:"lie", pl:"kÅ‚amstwo"}, {en:"signal", pl:"sygnaÅ‚"}, {en:"direction", pl:"kierunek"}, {en:"distance", pl:"odlegÅ‚oÅ›Ä‡"}, {en:"speed", pl:"prÄ™dkoÅ›Ä‡"}, {en:"silence", pl:"cisza"}, {en:"shadow", pl:"cieÅ„"}, {en:"shape", pl:"ksztaÅ‚t"}, {en:"size", pl:"rozmiar"}, {en:"level", pl:"poziom"}, {en:"amount", pl:"iloÅ›Ä‡"}, {en:"detail", pl:"szczegÃ³Å‚"}, {en:"example", pl:"przykÅ‚ad"}, {en:"chance", pl:"szansa"}, {en:"memory", pl:"wspomnienie"}, {en:"moment", pl:"chwila"}, {en:"past", pl:"przeszÅ‚oÅ›Ä‡"}, {en:"present", pl:"teraÅºniejszoÅ›Ä‡"}, {en:"future", pl:"przyszÅ‚oÅ›Ä‡"}, {en:"experience", pl:"doÅ›wiadczenie"}, {en:"skill", pl:"umiejÄ™tnoÅ›Ä‡"}, {en:"talent", pl:"talent"}, {en:"effort", pl:"wysiÅ‚ek"}, {en:"training", pl:"trening"}, {en:"career", pl:"kariera"}, {en:"goal", pl:"cel"}, {en:"decision", pl:"decyzja"}, {en:"choice", pl:"wybÃ³r"}, {en:"rule", pl:"zasada"}, {en:"law", pl:"prawo"}, {en:"order", pl:"porzÄ…dek"}, {en:"mess", pl:"baÅ‚agan"}, {en:"mistake", pl:"bÅ‚Ä…d"}, {en:"danger", pl:"niebezpieczeÅ„stwo"}, {en:"safety", pl:"bezpieczeÅ„stwo"}, {en:"risk", pl:"ryzyko"}, {en:"protection", pl:"ochrona"}, {en:"education", pl:"edukacja"}, {en:"information", pl:"informacja"}, {en:"news", pl:"wiadomoÅ›ci"}, {en:"event", pl:"wydarzenie"}, {en:"accident", pl:"wypadek"}, {en:"support", pl:"wsparcie"}, {en:"help", pl:"pomoc"},
    ]
};

// --- SKLEP (25 PRZEDMIOTÃ“W) ---
const SHOP_DATABASE = [
    {id:'b1', n:'BOMBA', p:50, icon:'ğŸ’£', type:'tool'},
    {id:'x2', n:'X2', p:100, icon:'âš¡', type:'tool'},
    {id:'c1', n:'BÅÄ˜KITNY', p:200, icon:'ğŸ¨', type:'color', val:'#00f2ff'},
    {id:'c2', n:'ZÅOTY', p:1500, icon:'ğŸ¨', type:'color', val:'#ffd700'},
    {id:'c3', n:'KRWISTY', p:300, icon:'ğŸ¨', type:'color', val:'#ff4757'},
    {id:'c4', n:'FIOLET', p:400, icon:'ğŸ¨', type:'color', val:'#a29bfe'},
    {id:'e1', n:'NINJA', p:300, icon:'ğŸ¥·', type:'emo'},
    {id:'e2', n:'BOGACZ', p:1000, icon:'ğŸ¤‘', type:'emo'},
    {id:'e3', n:'DUCH', p:200, icon:'ğŸ‘»', type:'emo'},
    {id:'e4', n:'NARCIARZ', p:350, icon:'â›·ï¸', type:'emo'},
    {id:'e5', n:'KRÄ˜GLE', p:150, icon:'ğŸ³', type:'emo'},
    {id:'e6', n:'SMOK', p:1200, icon:'ğŸ²', type:'emo'},
    {id:'e7', n:'ROBOT', p:600, icon:'ğŸ¤–', type:'emo'},
    {id:'e8', n:'DIAMENT', p:2000, icon:'ğŸ’', type:'emo'},
    {id:'e9', n:'PAD', p:450, icon:'ğŸ®', type:'emo'},
    {id:'e10', n:'KORONA', p:1800, icon:'ğŸ‘‘', type:'emo'},
    {id:'e11', n:'OGIEÅƒ', p:100, icon:'ğŸ”¥', type:'emo'},
    {id:'e12', n:'HAKER', p:700, icon:'ğŸ‘¨â€ğŸ’»', type:'emo'},
    {id:'e13', n:'KOSMOS', p:900, icon:'ğŸ‘©â€ğŸš€', type:'emo'},
    {id:'e14', n:'REKIN', p:800, icon:'ğŸ¦ˆ', type:'emo'},
    {id:'e15', n:'PIZZA', p:50, icon:'ğŸ•', type:'emo'},
    {id:'e16', n:'CZASZKA', p:300, icon:'ğŸ’€', type:'emo'},
    {id:'e17', n:'KOT', p:250, icon:'ğŸ±', type:'emo'},
    {id:'e18', n:'PUDEL', p:200, icon:'ğŸ©', type:'emo'},
    {id:'e19', n:'GWIAZDA', p:500, icon:'â­', type:'emo'}
];

// --- STAN GRACZA ---
let user = JSON.parse(localStorage.getItem('e8_pro_user')) || {
    name: "GRACZ", cups: 0, coins: 100, bombs: 0, x2: 0,
    avatar: "ğŸ‘¶ğŸ»", color: "#fff", unlockedArenas: [1],
    inventory: ["ğŸ‘¶ğŸ»", "#fff"]
};

let game = { active: false, mode: '', arena: 1, pool: [], idx: 0, lives: 3, mistakes: [] };

function save() {
    localStorage.setItem('e8_pro_user', JSON.stringify(user));
    db.ref('users/' + (localStorage.getItem('e8_uid') || 'u1')).set(user);
    updateUI();
}

function updateUI() {
    document.getElementById('p-name').textContent = user.name;
    document.getElementById('p-name').style.color = user.color;
    document.getElementById('p-avatar').textContent = user.avatar;
    document.getElementById('p-cups').textContent = user.cups;
    document.getElementById('p-coins').textContent = user.coins;
    document.getElementById('p-bombs').textContent = user.bombs;
    document.getElementById('p-x2').textContent = user.x2;
    renderRoad();
    renderLeaderboard();
}

// --- LOGIKA GRY ---
function openArenaSelector(mode) {
    game.mode = mode;
    showScreen('screen-dict');
    let h = '';
    for(let i=1; i<=5; i++) {
        let isLocked = !user.unlockedArenas.includes(i);
        h += `<button style="background:${isLocked ? '#222' : '#2980b9'}" onclick="${isLocked ? "alert('Zalicz poprzedniÄ… arenÄ™!')" : "startLevel("+i+")"}">
            ARENA ${i} ${isLocked ? 'ğŸ”’' : 'ğŸ”“'}
        </button>`;
    }
    document.getElementById('arena-grid').innerHTML = h;
}

function startLevel(arenaNum) {
    game.arena = arenaNum;
    game.idx = 0;
    game.lives = 3;
    game.mistakes = [];
    
    let fullPool = ARENA_DATA[arenaNum] || [{en:'Error', pl:'bÅ‚Ä…d'}];
    let count = (game.mode === 'rank') ? (arenaNum === 1 ? 50 : 30) : 20;
    
    game.pool = [...fullPool].sort(() => 0.5 - Math.random()).slice(0, count);
    
    showScreen('screen-game');
    updateGameUI();
}

function updateGameUI() {
    let cur = game.pool[game.idx];
    document.getElementById('g-arena-name').textContent = "ARENA " + game.arena + " (" + (game.idx + 1) + "/" + game.pool.length + ")";
    document.getElementById('g-lives').textContent = "â¤ï¸".repeat(game.lives);
    document.getElementById('g-word').textContent = cur.en.toUpperCase();
    document.getElementById('g-input').value = "";
    document.getElementById('g-feedback').textContent = "";
}

function checkAnswer() {
    let val = document.getElementById('g-input').value.toLowerCase().trim();
    let ans = game.pool[game.idx].pl.toLowerCase();
    
    if(val === ans) {
        game.idx++;
        document.getElementById('g-feedback').innerHTML = "<span style='color:lime'>DOBRZE!</span>";
        user.coins += 1;
        
        if(game.idx >= game.pool.length) {
            if(game.mistakes.length > 0) {
                game.pool = [...game.mistakes];
                game.mistakes = [];
                game.idx = 0;
                alert("Teraz popraw sÅ‚owa, w ktÃ³rych byÅ‚ bÅ‚Ä…d!");
                updateGameUI();
            } else {
                finishGame(true);
            }
        } else {
            setTimeout(updateGameUI, 500);
        }
    } else {
        game.lives--;
        game.mistakes.push(game.pool[game.idx]);
        document.getElementById('g-feedback').innerHTML = "<span style='color:red'>BÅÄ„D! POPRAWNIE: "+ans.toUpperCase()+"</span>";
        
        if(game.lives < 0) {
            alert("GAME OVER! Za duÅ¼o bÅ‚Ä™dÃ³w.");
            showScreen('screen-menu');
        } else {
            setTimeout(() => {
                game.idx++;
                if(game.idx >= game.pool.length) {
                    game.pool = [...game.mistakes];
                    game.mistakes = [];
                    game.idx = 0;
                    updateGameUI();
                } else {
                    updateGameUI();
                }
            }, 1500);
        }
    }
}

function finishGame(win) {
    let bonus = 0;
    if(game.mode === 'rank') {
        bonus = 50;
        if(!user.unlockedArenas.includes(game.arena + 1)) user.unlockedArenas.push(game.arena + 1);
    } else {
        let errCount = game.mistakes.length;
        if(errCount <= 1) bonus = 25;
        else if(errCount <= 3) bonus = 15;
    }
    
    user.cups += bonus;
    user.coins += 20;
    save();
    alert("KONIEC! ZyskaÅ‚eÅ› " + bonus + "ğŸ†");
    showScreen('screen-menu');
}

// --- SKLEP I SZAFKA ---
function renderShop() {
    let h = '';
    SHOP_DATABASE.forEach(i => {
        h += `<div class="shop-card">
            <span style="font-size:1.5rem">${i.icon}</span><br>
            <small style="font-size:0.5rem">${i.n}</small><br>
            <button style="padding:4px; font-size:0.6rem; background:#27ae60" onclick="buyItem('${i.id}')">${i.p}ğŸ’°</button>
        </div>`;
    });
    document.getElementById('shop-items').innerHTML = h;
}

function buyItem(id) {
    let itm = SHOP_DATABASE.find(x => x.id === id);
    if(user.coins >= itm.p) {
        user.coins -= itm.p;
        if(itm.type === 'tool') {
            if(itm.id === 'b1') user.bombs++; else user.x2++;
        } else {
            user.inventory.push(itm.val || itm.icon);
        }
        save();
        alert("Kupiono!");
    } else alert("Brak Å›rodkÃ³w!");
}

function renderLocker() {
    let h = '';
    user.inventory.forEach(inv => {
        let isColor = inv.includes('#');
        h += `<div class="shop-card" onclick="equip('${inv}')">
            <span style="color:${isColor?inv:'#fff'}">${isColor?'ğŸ¨':inv}</span>
        </div>`;
    });
    document.getElementById('locker-items').innerHTML = h;
}

function equip(val) {
    if(val.includes('#')) user.color = val;
    else user.avatar = val;
    save();
    alert("Wybrano!");
}

function renderRoad() {
    let h = '';
    for(let i=0; i<=2000; i+=100) {
        let gift = i > 0 && i % 500 === 0 ? 'ğŸ' : (i % 200 === 0 ? 'ğŸ’°' : 'ğŸ†');
        h += `<div class="node ${user.cups >= i ? 'unlocked' : ''}">
            <div class="node-box">${gift}</div>
            <div style="font-size:0.5rem">${i}</div>
        </div>`;
    }
    document.getElementById('road-ui').innerHTML = h;
}

function renderLeaderboard() {
    db.ref('users').orderByChild('cups').limitToLast(10).on('value', snap => {
        let arr = [];
        snap.forEach(child => { arr.push(child.val()); });
        arr.reverse();
        let h = '';
        arr.forEach((p, i) => {
            let cl = i === 0 ? 'rank-1' : (i === 1 ? 'rank-2' : (i === 2 ? 'rank-3' : ''));
            h += `<div style="display:flex; justify-content:space-between; padding:5px; border-bottom:1px solid #222" class="${cl}">
                <span>${i+1}. ${p.avatar} ${p.name}</span>
                <span>${p.cups}ğŸ†</span>
            </div>`;
        });
        document.getElementById('leader-list').innerHTML = h;
    });
}

function updateNick() {
    let n = document.getElementById('new-nick').value.toUpperCase();
    if(n) { user.name = n; save(); showScreen('screen-menu'); }
}

function showScreen(id) {
    document.querySelectorAll('.app').forEach(s => s.classList.add('hidden'));
    document.getElementById(id).classList.remove('hidden');
}

// Start
if(!localStorage.getItem('e8_uid')) localStorage.setItem('e8_uid', 'u' + Date.now());
updateUI();
renderShop();
renderLocker();
</script>
</body>
</html>
